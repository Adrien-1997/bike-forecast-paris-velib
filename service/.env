# =============================================================================
#  Vélib’ Forecast — Environment (.env)
# =============================================================================
#  Format: KEY=VALUE
#  Usage:
#     export $(grep -v '^#' .env | xargs)
#     ou pour Docker/Cloud Run : directement injecté comme env vars
# =============================================================================

# ──────────────────────────────── PROJECT / GCS ───────────────────────────────
GCP_REGION=europe-west1
GCP_PROJECT=velib-forecast-472820

# Racine GCS principale
GCS_BUCKET_ROOT=gs://velib-forecast-472820_cloudbuild/velib

# Parquet-first pipeline
GCS_RAW_PREFIX=${GCS_BUCKET_ROOT}/bronze
GCS_DAILY_PREFIX=${GCS_BUCKET_ROOT}/daily
GCS_SERVING_ROOT=${GCS_BUCKET_ROOT}/serving
GCS_MODELS_PREFIX=${GCS_BUCKET_ROOT}/models

# Exports et monitoring
GCS_EXPORTS_PREFIX=${GCS_BUCKET_ROOT}/exports
GCS_MONITORING_PREFIX=${GCS_BUCKET_ROOT}/monitoring

# ─────────────────────────────── API / CORS / AUTH ────────────────────────────
API_SELF_BASE=https://api.velo-paris.fr
LIVE_SNAPSHOT_URL=/snapshot
API_GLOBAL_TOKEN=secure-api-token



# ──────────────────────────────── EXTERNAL SOURCES ────────────────────────────
VELIB_STATUS_URL=https://velib-metropole-opendata.smovengo.cloud/opendata/Velib_Metropole/station_status.json
VELIB_INFO_URL=https://velib-metropole-opendata.smovengo.cloud/opendata/Velib_Metropole/station_information.json

OPENMETEO_URL=https://api.open-meteo.com/v1/forecast
OPENMETEO_LAT=48.8566
OPENMETEO_LON=2.3522
OPENMETEO_TIMEOUT=5.0
METEO_DISABLE=false

# ──────────────────────────────── FORECAST (SERVING) ──────────────────────────
SERVING_FORECAST_PREFIX=${GCS_SERVING_ROOT}/forecast

# Horizons supportés (minutes)
FORECAST_HORIZONS=15,60
FORECAST_SUPPORTED=15,60

# Modèles
MODEL_URI_15=${GCS_MODELS_PREFIX}/h15/latest.joblib
MODEL_URI_60=${GCS_MODELS_PREFIX}/h60/latest.joblib

# Compatibilité legacy
GCS_MODEL_URI=${GCS_MODELS_PREFIX}/lgb_nbvelos_T+15min.joblib

# Cache TTL (en secondes)
FORECAST_CACHE_TTL_SECONDS=120

# Exemple de sorties :
#   ${SERVING_FORECAST_PREFIX}/h15/latest.json
#   ${SERVING_FORECAST_PREFIX}/h60/latest.json

# ─────────────────────────────── MONITORING (UNIFIÉ) ──────────────────────────
MON_TZ=Europe/Paris
MON_LAST_DAYS=14
MON_REF_DAYS=28
MON_PENURY_THRESH=2
MON_SATURATION_THRESH=2

# Network Overview
OVERVIEW_TZ=${MON_TZ}
OVERVIEW_LAST_DAYS=28
OVERVIEW_REF_DAYS=28

# Network Dynamics
DYNAMICS_TZ=${MON_TZ}
DYNAMICS_LAST_DAYS=14

# Network Stations
NETWORK_WINDOW_DAYS=14
NETWORK_MIN_BINS_KEEP=50
STATIONS_MAX=3000
# NETWORK_K=5
# NETWORK_K_MIN=2
# NETWORK_K_MAX=8

# Model Performance / Explainability
PERF_LAST_DAYS=14
LOOKBACK_DAYS=14

# Data Health
DATA_HEALTH_LAST_DAYS=14
DATA_HEALTH_CURRENT_DAYS=14

# Data Drift
# (les jobs v1.4 lisent MON_LAST_DAYS / MON_REF_DAYS directement)

# ──────────────────────────────── RUNTIME / SYSTEM ────────────────────────────
TZ_APP=Europe/Paris
TMP_DIR=/tmp
PYTHONUNBUFFERED=1

# ────────────────────────────────── LOG / DEBUG ───────────────────────────────
LOG_LEVEL=INFO
